{
    "codeql-code-inspection": {
        "Id": "codeql-code-inspection",
        "Title": "CodeQL Code Inspection",
        "Description": "CodeQL Code Inspection",
        "Usage": 1,
        "Type": 1,
        "Size": 1,
        "Technology": 25,
        "Machine": 1,
        "Internet": true,
        "MultiTenant": false,
        "Redundant": false,
        "CustomDevelopedParts": false,
        "OutOfScope": false,
        "UsedAsClientByHuman": false,
        "Encryption": 0,
        "JustificationOutOfScope": "",
        "Owner": "dfe",
        "Confidentiality": 3,
        "Integrity": 2,
        "Availability": 1,
        "JustificationCiaRating": "Sourcecode inspection platforms are rated at least 'important' in terms of integrity, because any malicious modification of it might lead to vulnerabilities found by the scanner engine not being shown.",
        "Tags": [
            "codeql"
        ],
        "DataAssetsProcessed": [
            "sourcecode"
        ],
        "DataAssetsStored": [
            "sourcecode"
        ],
        "DataFormatsAccepted": [
            3
        ],
        "CommunicationLinks": [],
        "DiagramTweakOrder": 0,
        "RAA": 14.855072463768115
    },
    "github-actions-build-pipeline": {
        "Id": "github-actions-build-pipeline",
        "Title": "GitHub Actions Build Pipeline",
        "Description": "GitHub Actions Build Pipeline",
        "Usage": 1,
        "Type": 1,
        "Size": 1,
        "Technology": 22,
        "Machine": 1,
        "Internet": true,
        "MultiTenant": false,
        "Redundant": false,
        "CustomDevelopedParts": false,
        "OutOfScope": false,
        "UsedAsClientByHuman": false,
        "Encryption": 0,
        "JustificationOutOfScope": "",
        "Owner": "dfe",
        "Confidentiality": 3,
        "Integrity": 3,
        "Availability": 2,
        "JustificationCiaRating": "Build pipeline components are at least rated as 'critical' in terms of integrity, because any malicious modification of it might lead to a backdoored production system.",
        "Tags": [
            "github-actions"
        ],
        "DataAssetsProcessed": [
            "sourcecode"
        ],
        "DataAssetsStored": [
            "sourcecode"
        ],
        "DataFormatsAccepted": [
            3
        ],
        "CommunicationLinks": [
            {
                "Id": "github-actions-build-pipeline\u003ecode-inspection-platform-traffic",
                "SourceId": "github-actions-build-pipeline",
                "TargetId": "codeql-code-inspection",
                "Title": "Code Inspection Platform Traffic",
                "Description": "Code Inspection Platform Traffic",
                "Protocol": 2,
                "Tags": [
                    "codeql"
                ],
                "VPN": false,
                "IpFiltered": false,
                "Readonly": false,
                "Authentication": 1,
                "Authorization": 1,
                "Usage": 1,
                "DataAssetsSent": [
                    "sourcecode"
                ],
                "DataAssetsReceived": null,
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            },
            {
                "Id": "github-actions-build-pipeline\u003efunction-app-push",
                "SourceId": "github-actions-build-pipeline",
                "TargetId": "rust-function-app",
                "Title": "Function App Push",
                "Description": "Deployment of the Rust function app and infrastructure",
                "Protocol": 2,
                "Tags": [
                    "azure-function-app"
                ],
                "VPN": false,
                "IpFiltered": false,
                "Readonly": false,
                "Authentication": 3,
                "Authorization": 1,
                "Usage": 1,
                "DataAssetsSent": [
                    "sourcecode"
                ],
                "DataAssetsReceived": [
                    "sourcecode"
                ],
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            },
            {
                "Id": "github-actions-build-pipeline\u003esourcecode-repository-traffic",
                "SourceId": "github-actions-build-pipeline",
                "TargetId": "github-sourcecode-repository",
                "Title": "Sourcecode Repository Traffic",
                "Description": "Sourcecode Repository Traffic",
                "Protocol": 2,
                "Tags": [
                    "git",
                    "github"
                ],
                "VPN": false,
                "IpFiltered": false,
                "Readonly": true,
                "Authentication": 1,
                "Authorization": 1,
                "Usage": 1,
                "DataAssetsSent": null,
                "DataAssetsReceived": [
                    "sourcecode"
                ],
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            }
        ],
        "DiagramTweakOrder": 0,
        "RAA": 53.17199156728667
    },
    "github-sourcecode-repository": {
        "Id": "github-sourcecode-repository",
        "Title": "GitHub Sourcecode Repository",
        "Description": "github Sourcecode Repository",
        "Usage": 1,
        "Type": 1,
        "Size": 1,
        "Technology": 23,
        "Machine": 1,
        "Internet": true,
        "MultiTenant": false,
        "Redundant": false,
        "CustomDevelopedParts": false,
        "OutOfScope": false,
        "UsedAsClientByHuman": false,
        "Encryption": 0,
        "JustificationOutOfScope": "",
        "Owner": "dfe",
        "Confidentiality": 3,
        "Integrity": 3,
        "Availability": 2,
        "JustificationCiaRating": "Sourcecode processing components are at least rated as 'critical' in terms of integrity, because any malicious modification of it might lead to a backdoored production system.",
        "Tags": [
            "github"
        ],
        "DataAssetsProcessed": [
            "sourcecode"
        ],
        "DataAssetsStored": [
            "sourcecode"
        ],
        "DataFormatsAccepted": [
            3
        ],
        "CommunicationLinks": [],
        "DiagramTweakOrder": 0,
        "RAA": 32.850241545893724
    },
    "key-vault": {
        "Id": "key-vault",
        "Title": "Key Vault",
        "Description": "The key vault containing keys for sensitive systems, and the Splunk data ingestion HEC token.",
        "Usage": 0,
        "Type": 2,
        "Size": 1,
        "Technology": 48,
        "Machine": 1,
        "Internet": true,
        "MultiTenant": false,
        "Redundant": false,
        "CustomDevelopedParts": false,
        "OutOfScope": false,
        "UsedAsClientByHuman": false,
        "Encryption": 2,
        "JustificationOutOfScope": "",
        "Owner": "dfe",
        "Confidentiality": 4,
        "Integrity": 2,
        "Availability": 2,
        "JustificationCiaRating": "KeyVault should be properly secured due to the increasing attack surface that would result from leaking the secrets within.",
        "Tags": [
            "azure-key-vault"
        ],
        "DataAssetsProcessed": [
            "secrets-and-api-keys"
        ],
        "DataAssetsStored": [
            "secrets-and-api-keys"
        ],
        "DataFormatsAccepted": [
            0
        ],
        "CommunicationLinks": [],
        "DiagramTweakOrder": 0,
        "RAA": 92.27053140096618
    },
    "rust-function-app": {
        "Id": "rust-function-app",
        "Title": "Rust Function App",
        "Description": "The Rust Function App collects data from Azure, O365, AWS, GitHub.",
        "Usage": 0,
        "Type": 0,
        "Size": 2,
        "Technology": 37,
        "Machine": 3,
        "Internet": true,
        "MultiTenant": false,
        "Redundant": false,
        "CustomDevelopedParts": false,
        "OutOfScope": false,
        "UsedAsClientByHuman": false,
        "Encryption": 0,
        "JustificationOutOfScope": "",
        "Owner": "dfe",
        "Confidentiality": 3,
        "Integrity": 3,
        "Availability": 2,
        "JustificationCiaRating": "The function app handles sensitive keys and processess sensitive system infromation from across the estate.",
        "Tags": [
            "azure-function-app"
        ],
        "DataAssetsProcessed": [
            "sourcecode",
            "secrets-and-api-keys",
            "splunk-data"
        ],
        "DataAssetsStored": [
            "secrets-and-api-keys",
            "splunk-data"
        ],
        "DataFormatsAccepted": [
            0
        ],
        "CommunicationLinks": [
            {
                "Id": "rust-function-app\u003eretrieve-keys",
                "SourceId": "rust-function-app",
                "TargetId": "key-vault",
                "Title": "Retrieve keys",
                "Description": "The function must retrieve keys from Key Vault in order to call APIs and send data to Splunk.",
                "Protocol": 2,
                "Tags": [
                    "azure",
                    "splunk"
                ],
                "VPN": false,
                "IpFiltered": false,
                "Readonly": true,
                "Authentication": 3,
                "Authorization": 1,
                "Usage": 0,
                "DataAssetsSent": [
                    "secrets-and-api-keys"
                ],
                "DataAssetsReceived": [
                    "secrets-and-api-keys"
                ],
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            },
            {
                "Id": "rust-function-app\u003esend-data-to-splunk",
                "SourceId": "rust-function-app",
                "TargetId": "splunk",
                "Title": "Send data to Splunk",
                "Description": "Data collected and sent to SplunkCloud for analysis, via a HEC token.",
                "Protocol": 2,
                "Tags": [
                    "splunk"
                ],
                "VPN": false,
                "IpFiltered": true,
                "Readonly": false,
                "Authentication": 3,
                "Authorization": 1,
                "Usage": 1,
                "DataAssetsSent": [
                    "splunk-data"
                ],
                "DataAssetsReceived": null,
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            },
            {
                "Id": "rust-function-app\u003ebuild-pipeline-traffic",
                "SourceId": "rust-function-app",
                "TargetId": "github-actions-build-pipeline",
                "Title": "Build Pipeline Traffic",
                "Description": "Build Pipeline Traffic",
                "Protocol": 2,
                "Tags": [
                    "github-actions"
                ],
                "VPN": false,
                "IpFiltered": false,
                "Readonly": true,
                "Authentication": 3,
                "Authorization": 1,
                "Usage": 1,
                "DataAssetsSent": [
                    "sourcecode"
                ],
                "DataAssetsReceived": [
                    "sourcecode"
                ],
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            },
            {
                "Id": "rust-function-app\u003ecode-inspection-platform-traffic",
                "SourceId": "rust-function-app",
                "TargetId": "codeql-code-inspection",
                "Title": "Code Inspection Platform Traffic",
                "Description": "Code Inspection Platform Traffic",
                "Protocol": 2,
                "Tags": [
                    "codeql"
                ],
                "VPN": false,
                "IpFiltered": false,
                "Readonly": true,
                "Authentication": 3,
                "Authorization": 1,
                "Usage": 1,
                "DataAssetsSent": null,
                "DataAssetsReceived": [
                    "sourcecode"
                ],
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            },
            {
                "Id": "rust-function-app\u003esourcecode-repository-traffic",
                "SourceId": "rust-function-app",
                "TargetId": "github-sourcecode-repository",
                "Title": "Sourcecode Repository Traffic",
                "Description": "Sourcecode Repository Traffic",
                "Protocol": 2,
                "Tags": [
                    "github",
                    "git"
                ],
                "VPN": false,
                "IpFiltered": false,
                "Readonly": false,
                "Authentication": 3,
                "Authorization": 1,
                "Usage": 1,
                "DataAssetsSent": [
                    "sourcecode"
                ],
                "DataAssetsReceived": [
                    "sourcecode"
                ],
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            },
            {
                "Id": "rust-function-app\u003eapi-calls-to-services",
                "SourceId": "rust-function-app",
                "TargetId": "various-service-rest-endpoints",
                "Title": "API Calls to Services",
                "Description": "The function makes multiple API calls to Azure, AWS, O365 and GitHub.",
                "Protocol": 2,
                "Tags": [
                    "azure",
                    "o365",
                    "github"
                ],
                "VPN": false,
                "IpFiltered": false,
                "Readonly": true,
                "Authentication": 3,
                "Authorization": 1,
                "Usage": 0,
                "DataAssetsSent": [
                    "secrets-and-api-keys",
                    "sourcecode"
                ],
                "DataAssetsReceived": [
                    "splunk-data"
                ],
                "DiagramTweakWeight": 1,
                "DiagramTweakConstraint": true
            }
        ],
        "DiagramTweakOrder": 0,
        "RAA": 100
    },
    "splunk": {
        "Id": "splunk",
        "Title": "Splunk",
        "Description": "All data from the function app ends up in Splunk for analysis.",
        "Usage": 0,
        "Type": 2,
        "Size": 1,
        "Technology": 44,
        "Machine": 1,
        "Internet": true,
        "MultiTenant": false,
        "Redundant": false,
        "CustomDevelopedParts": false,
        "OutOfScope": false,
        "UsedAsClientByHuman": false,
        "Encryption": 2,
        "JustificationOutOfScope": "",
        "Owner": "dfe",
        "Confidentiality": 4,
        "Integrity": 2,
        "Availability": 2,
        "JustificationCiaRating": "KeyVault should be properly secured due to the increasing attack surface that would result from leaking the secrets within.",
        "Tags": [
            "splunk"
        ],
        "DataAssetsProcessed": [
            "splunk-data"
        ],
        "DataAssetsStored": [
            "splunk-data"
        ],
        "DataFormatsAccepted": [
            0
        ],
        "CommunicationLinks": [],
        "DiagramTweakOrder": 0,
        "RAA": 90.09661835748793
    },
    "various-service-rest-endpoints": {
        "Id": "various-service-rest-endpoints",
        "Title": "Various service REST endpoints",
        "Description": "Various service REST endpoints we collect data from.",
        "Usage": 0,
        "Type": 2,
        "Size": 1,
        "Technology": 14,
        "Machine": 1,
        "Internet": true,
        "MultiTenant": false,
        "Redundant": false,
        "CustomDevelopedParts": false,
        "OutOfScope": true,
        "UsedAsClientByHuman": false,
        "Encryption": 2,
        "JustificationOutOfScope": "Not part of the overall system, or managed by the team.",
        "Owner": "azure and dfe share responsibility",
        "Confidentiality": 4,
        "Integrity": 2,
        "Availability": 2,
        "JustificationCiaRating": "We are not in control of these assets, we simply use them to retrieve data.",
        "Tags": [
            "azure"
        ],
        "DataAssetsProcessed": [
            "secrets-and-api-keys",
            "splunk-data"
        ],
        "DataAssetsStored": [
            "splunk-data"
        ],
        "DataFormatsAccepted": [
            0
        ],
        "CommunicationLinks": [],
        "DiagramTweakOrder": 0,
        "RAA": 1
    }
}